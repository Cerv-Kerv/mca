{% extends "layouts/main.html" %}

{% block pageTitle %}
  Choose a time for the exam – {{ serviceName }} – GOV.UK Prototype Kit
{% endblock %}

{% block header %}
  <!-- Blank header with no service name for the start page -->
  {% from "govuk/components/header/macro.njk" import govukHeader %}
{% from "govuk/components/service-navigation/macro.njk" import govukServiceNavigation %}

{{ hmrcHeader({
  serviceUrl : "/",
  useTudorCrown: "true"
}) }}
{{ govukServiceNavigation({
    serviceName: "Book and manage an oral exam",
  navigation: [   
],
    slots: {
      navigationEnd: '<div class="service-menu-signout-wrapper"><a class="govuk-link govuk-link--no-visited-state service-menu-signout" href="signed-out?sign-out">Sign out</a></div>'
    },
    classes: "govuk-header--full-width-border"
  }) }}
{% endblock %}

{% block beforeContent %}
  {{ govukPhaseBanner({
    tag: {
      text: "Beta"
    },
    html: 'This is a new service – your <a class="govuk-link" href="#">feedback</a> will help us to improve it.'
  }) }}
  
  {{ govukBackLink({
    text: "Back",
    href: "javascript:window.history.back()"
  }) }}
{% endblock %}

{% block content %}

  <div class="govuk-grid-row">
    <div class="govuk-grid-column-full">

      <!-- {% if data['slot-error'] == 'true' %}
        {{ govukErrorSummary({
          titleText: "There is a problem",
          errorList: [{
            text: "Select an appointment time",
            href: "#morning-slots"
          }]
        }) }}
      {% endif %} -->

      <h1 class="govuk-heading-l">
        <span class="govuk-caption-l">MEOL and Senior MEOL exam</span>
        Choose a time for the exam
      </h1>

      <div class="govuk-grid-row" id="pageContent">
        <div class="govuk-grid-column-full">
            <ol class="appointment-tabs"></ol>
<nav role="navigation">
    <ul class="weekly-navigation only-desktop">
        <li class="govuk-body">
            <a class="govuk-link" id="lastWeek-desktop" href="#">&lt; Previous week</a>
        </li>
        <li class="govuk-body nav-next">
            <a class="govuk-link" id="nextWeek-desktop" href="#">Next week &gt;</a>
        </li>
    </ul>
    <ul class="weekly-navigation only-mobile">
        <li class="govuk-body">
            <a class="govuk-link" id="lastWeek-mobile" href="#">&lt; Previous</a>
        </li>
        <li class="govuk-body nav-next">
            <a class="govuk-link" id="nextWeek-mobile" href="#">Next &gt;</a>
        </li>
    </ul>
</nav>
<script>
// BEGINS 7 DAY WEEK TABS
document.addEventListener("DOMContentLoaded", function () {
  const appointmentTabs = document.querySelector('.appointment-tabs');
  if (!appointmentTabs) return;

  const weekdays = ['Monday','Tuesday','Wednesday','Thursday','Friday'];
  const months   = [
    'January','February','March','April','May','June','July',
    'August','September','October','November','December'
  ];
  

  // Find which day is selected, if any
  function getSelectedISO() {
    return localStorage.getItem('chosenAppointmentDate');
  }

  // Given Monday date, render the week tabs
  function renderTabs(mondayDate) {
    appointmentTabs.innerHTML = '';
    const selectedISO = getSelectedISO();
    const selectedDate = selectedISO ? new Date(selectedISO) : null;

    for (let i = 0; i < 5; i++) {
      let currentDate = new Date(mondayDate);
      currentDate.setDate(mondayDate.getDate() + i);
      let weekday = weekdays[i];
      let day = currentDate.getDate();
      let month = months[currentDate.getMonth()];
      let tabId = `appointmentDate-${i+1}`;
      let slotText, slotClass;

      // If weekend, mark as no slots
      if (i >= 5) {
        slotText = 'No slots';
        slotClass = 'tab-slots-not-available govuk-body-s';
      } else {
        slotText = `${6 - i*1} slots`;
        slotClass = 'tab-slots-available govuk-body-s';
      }

      // Make this tab active if it matches the saved date!
      let liClass = '';
      if (
        selectedDate &&
        currentDate.getDate() === selectedDate.getDate() &&
        currentDate.getMonth() === selectedDate.getMonth() &&
        currentDate.getFullYear() === selectedDate.getFullYear()
      ) {
        liClass = 'tab-0';
      }

      if (i >= 3) { // 3=Thursday, 4=Friday, 5=Saturday
    liClass += (liClass ? ' ' : '') + 'mobile-hidden';
  }

      appointmentTabs.innerHTML += `
        <li class="${liClass}">
          <a href="#" id="${tabId}">
            <span class="tab-day">${weekday}</span>
            <span class="tab-date">${day} ${month}</span>
            <span class="${slotClass}" id="slotsText-${i+1}">${slotText}</span>
          </a>
        </li>
      `;
    }
  }

  // Find starting Monday
  function getMonday(date) {
    let d = new Date(date);
    let dow = d.getDay();
    let diffToMonday = (dow === 0) ? -6 : (1 - dow);
    d.setDate(d.getDate() + diffToMonday);
    d.setHours(0,0,0,0);
    return d;
  }

  // Read initial date, render initial week
  let selectedISO = localStorage.getItem('chosenAppointmentDate');
  let baseDate = selectedISO ? new Date(selectedISO) : new Date();
  let currentMonday = getMonday(baseDate);

  function rerenderTabs() {
  renderTabs(currentMonday);

  attachTabClickHandlers(); // Attach handlers for tab clicks

  // Determine which tab should be active on load
  const appointmentTabs = document.querySelector('.appointment-tabs');
  const slotsContainer = document.getElementById('slots');
  let activeTabId;

  // Use "chosenAppointmentDate" in localStorage if set
  let selectedISO = localStorage.getItem('chosenAppointmentDate');
  if (selectedISO) {
    let selectedDate = new Date(selectedISO);
    // Find matching tab by date in rendered tabs
    let foundIdx = null;
    appointmentTabs.querySelectorAll('li a').forEach(function(tabAnchor, idx){
      const tabDateText = tabAnchor.querySelector('.tab-date').textContent; // e.g. "25 September"
      // Parse tabDateText to date (requires knowing the current week start, so leverage idx)
      let tabDate = new Date(currentMonday);
      tabDate.setDate(currentMonday.getDate() + idx);

      if (
        tabDate.getDate() === selectedDate.getDate() &&
        tabDate.getMonth() === selectedDate.getMonth() &&
        tabDate.getFullYear() === selectedDate.getFullYear()
      ) {
        activeTabId = tabAnchor.id;
        foundIdx = idx;
      }
    });
    if (!activeTabId) {
      // fallback to first tab
      activeTabId = 'appointmentDate-1';
    }
  } else {
    // Use first tab by default
    activeTabId = 'appointmentDate-0';
  }

  // Set tab-0 class to correct <li>
  appointmentTabs.querySelectorAll('li').forEach(li => li.classList.remove('tab-0'));
  const activeTabAnchor = appointmentTabs.querySelector('a#' + activeTabId);
  if (activeTabAnchor) {
    activeTabAnchor.parentElement.classList.add('tab-0');
    // Show slots for correct tab
    if (slotsContent[activeTabId]) {
      slotsContainer.innerHTML = slotsContent[activeTabId];
    } else {
      slotsContainer.innerHTML = noSlotsContent;
    }
  }
}

  

  // Navigation listeners for previous/next week, then rerender the appointments
  ['lastWeek-desktop','nextWeek-desktop','lastWeek-mobile','nextWeek-mobile'].forEach(id => {
    let el = document.getElementById(id);
    if (!el) return;
    if (id.includes('lastWeek')) {
      el.addEventListener("click", function(e){
        e.preventDefault();
        currentMonday.setDate(currentMonday.getDate() - 7);
        rerenderTabs();
      });
    } else {
      el.addEventListener("click", function(e){
        e.preventDefault();
        currentMonday.setDate(currentMonday.getDate() + 7);
        rerenderTabs();
      });
    }
  });

  rerenderTabs();

  // Optionally, rerender tabs whenever a new date is picked from calendar
  window.addEventListener('storage', (event) => {
    if (event.key === 'chosenAppointmentDate') {
      let pickedDate = event.newValue ? new Date(event.newValue) : null;
      if (pickedDate) {
        currentMonday = getMonday(pickedDate);
        rerenderTabs();
      }
    }
  });

  // --- If picker and slots live on same page, call rerenderTabs() after picking date, or trigger a re-render manually. ---

  document.addEventListener("DOMContentLoaded", function () {
  function handleTabClickEvents() {
    const appointmentTabs = document.querySelector('.appointment-tabs');
    if (!appointmentTabs) return;

    appointmentTabs.querySelectorAll('li').forEach(function (li, idx) {
      li.addEventListener('click', function (e) {
        e.preventDefault();

        // Remove "tab-0" from all li
        appointmentTabs.querySelectorAll('li').forEach(function (item) {
          item.classList.remove('tab-0');
        });

        // Add "tab-0" to clicked li
        li.classList.add('tab-0');

        // Show (or update) appointment slots div
        const slotsDiv = document.getElementById('slots');
        if (slotsDiv) {
          // Optional: insert code here to show relevant slots for the tab
          // Example placeholder:
          slotsDiv.innerHTML = `<p>Slots for tab ${idx + 1}</p>`;
        }

        // Save selected date if needed (e.g. using localStorage)
        // localStorage.setItem('chosenAppointmentDate', ... )
      });
    });
  }

  const appointmentTabs = document.querySelector('.appointment-tabs');
const slotsContainer = document.getElementById('slots');

function clearTabClasses() {
  document.querySelectorAll('.appointment-tabs li').forEach(li => {
    li.classList.remove('tab-0');
  });
}

function handleTabActivation(tabAnchor) {
  const key = tabAnchor.getAttribute('id');
  if (slotsContent[key]) {
    slotsContainer.innerHTML = slotsContent[key];
  } else {
    slotsContainer.innerHTML = `
      <h2 class="govuk-heading-l">Available slots</h2>
      <p>No slots available.</p>
      
    `;
  }
}

function attachTabClickHandlers() {
  // Remove old handlers first
  document.querySelectorAll('.appointment-tabs li a').forEach(tabAnchor => {
    tabAnchor.onclick = null;
    tabAnchor.addEventListener('click', function(event) {
      event.preventDefault();
      clearTabClasses();
      this.parentElement.classList.add('tab-0');
      handleTabActivation(this);
    });
  });
}

function activateFirstTabAndSlots() {
  const appointmentTabs = document.querySelector('.appointment-tabs');
  const slotsContainer = document.getElementById('slots');
  const firstTab = appointmentTabs.querySelector('li a');
  if (!firstTab) return;
  // Remove all active classes
  appointmentTabs.querySelectorAll('li').forEach(li => li.classList.remove('tab-0'));
  // Activate first tab
  firstTab.parentElement.classList.add('tab-0');
  // Show corresponding slots
  const firstTabId = firstTab.getAttribute('id');
  if (slotsContent[firstTabId]) {
    slotsContainer.innerHTML = slotsContent[firstTabId];
  } else {
    slotsContainer.innerHTML = noSlotsContent;
  }
}

  // Call attachTabClickHandlers() after tabs are (re)rendered
rerenderTabs();
attachTabClickHandlers();
activateFirstTabAndSlots();
});

  // auto display slot content TO FIX
  

});
//
// BEGINS DUMMY CONTENT 
document.addEventListener("DOMContentLoaded", function () {
  // -- Tab content for each day (hardcoded )
  // Uses the tab ID (appointmentDate-1) as the keys
  const slotsContent = {
    "appointmentDate-1": `
  <h2 class="govuk-heading-l">Available slots</h2>
  <div class="govuk-inset-text">
    All times are shown in British Summer Time (BST) timezone.
  </div>
  <p class="govuk-visually-hidden">Monday 13 October 2025</p>
  

  <div class="morning-slots">
      <form method="post" action="reschedule-check-your-answers">
          <input type="hidden" name="appointmentTime" value="08:00">
          <input type="hidden" name="slotId" value="2025-10-13T08:00:00.000Z">
          <button type="submit" class="govuk-button govuk-button--secondary" data-module="govuk-button">08:00</button>
      </form>
      <form method="post" action="reschedule-check-your-answers">
          <input type="hidden" name="appointmentTime" value="10:00">
          <input type="hidden" name="slotId" value="2025-10-13T10:00:00.000Z">
          <button type="submit" class="govuk-button govuk-button--secondary" data-module="govuk-button">10:00</button>
      </form>
      <form method="post" action="reschedule-check-your-answers">
          <input type="hidden" name="appointmentTime" value="11:30">
          <input type="hidden" name="slotId" value="2025-10-13T11:30:00.000Z">
          <button type="submit" class="govuk-button govuk-button--secondary" data-module="govuk-button">11:30</button>
      </form>
  </div>
  

  <div class="afternoon-slots">
      <form method="post" action="reschedule-check-your-answers">
          <input type="hidden" name="appointmentTime" value="12:30">
          <input type="hidden" name="slotId" value="2025-10-13T12:30:00.000Z">
          <button type="submit" class="govuk-button govuk-button--secondary" data-module="govuk-button">12:30</button>
      </form>
      <form method="post" action="reschedule-check-your-answers">
          <input type="hidden" name="appointmentTime" value="14:00">
          <input type="hidden" name="slotId" value="2025-10-13T14:00:00.000Z">
          <button type="submit" class="govuk-button govuk-button--secondary" data-module="govuk-button">14:00</button>
      </form>
      <form method="post" action="reschedule-check-your-answers">
          <input type="hidden" name="appointmentTime" value="16:00">
          <input type="hidden" name="slotId" value="2025-10-13T16:00:00.000Z">
          <button type="submit" class="govuk-button govuk-button--secondary" data-module="govuk-button">16:00</button>
      </form>
  </div>
`,
   "appointmentDate-2": `
  <h2 class="govuk-heading-l">Available slots</h2>
  <div class="govuk-inset-text">
    All times are shown in British Summer Time (BST) timezone.
  </div>
  <p class="govuk-visually-hidden">Tuesday 14 October 2025</p>
  

  <div class="morning-slots">
      <form method="post" action="reschedule-check-your-answers">
          <input type="hidden" name="appointmentTime" value="08:00">
          <input type="hidden" name="slotId" value="2025-10-14T08:00:00.000Z">
          <button type="submit" class="govuk-button govuk-button--secondary" data-module="govuk-button">08:00</button>
      </form>
      <form method="post" action="reschedule-check-your-answers">
          <input type="hidden" name="appointmentTime" value="10:00">
          <input type="hidden" name="slotId" value="2025-10-14T10:00:00.000Z">
          <button type="submit" class="govuk-button govuk-button--secondary" data-module="govuk-button">10:00</button>
      </form>
      
  </div>
  

  <div class="afternoon-slots">
      <form method="post" action="reschedule-check-your-answers">
          <input type="hidden" name="appointmentTime" value="12:30">
          <input type="hidden" name="slotId" value="2025-10-14T12:30:00.000Z">
          <button type="submit" class="govuk-button govuk-button--secondary" data-module="govuk-button">12:30</button>
      </form>
      <form method="post" action="reschedule-check-your-answers">
          <input type="hidden" name="appointmentTime" value="14:00">
          <input type="hidden" name="slotId" value="2025-10-14T14:00:00.000Z">
          <button type="submit" class="govuk-button govuk-button--secondary" data-module="govuk-button">14:00</button>
      </form>
      <form method="post" action="reschedule-check-your-answers">
          <input type="hidden" name="appointmentTime" value="16:00">
          <input type="hidden" name="slotId" value="2025-10-14T16:00:00.000Z">
          <button type="submit" class="govuk-button govuk-button--secondary" data-module="govuk-button">16:00</button>
      </form>
  </div>
`,

"appointmentDate-3": `
  <h2 class="govuk-heading-l">Available slots</h2>
  <div class="govuk-inset-text">
    All times are shown in British Summer Time (BST) timezone.
  </div>
  <p class="govuk-visually-hidden">Wednesday 15 October 2025</p>
  

  <div class="morning-slots">
      <form method="post" action="reschedule-check-your-answers">
          <input type="hidden" name="appointmentTime" value="08:00">
          <input type="hidden" name="slotId" value="2025-10-15T08:00:00.000Z">
          <button type="submit" class="govuk-button govuk-button--secondary" data-module="govuk-button">08:00</button>
      </form>
      <form method="post" action="reschedule-check-your-answers">
          <input type="hidden" name="appointmentTime" value="11:30">
          <input type="hidden" name="slotId" value="2025-10-15T11:30:00.000Z">
          <button type="submit" class="govuk-button govuk-button--secondary" data-module="govuk-button">11:30</button>
      </form>
  </div>
  

  <div class="afternoon-slots">
      <form method="post" action="reschedule-check-your-answers">
          <input type="hidden" name="appointmentTime" value="12:30">
          <input type="hidden" name="slotId" value="2025-10-15T12:30:00.000Z">
          <button type="submit" class="govuk-button govuk-button--secondary" data-module="govuk-button">12:30</button>
      </form>
      <form method="post" action="reschedule-check-your-answers">
          <input type="hidden" name="appointmentTime" value="14:00">
          <input type="hidden" name="slotId" value="2025-10-15T14:00:00.000Z">
          <button type="submit" class="govuk-button govuk-button--secondary" data-module="govuk-button">14:00</button>
      </form>
  </div>
`,

"appointmentDate-4": `
  <h2 class="govuk-heading-l">Available slots</h2>
  <div class="govuk-inset-text">
    All times are shown in British Summer Time (BST) timezone.
  </div>
  <p class="govuk-visually-hidden">Thursday 16 October 2025</p>
  

  <div class="morning-slots">
      <form method="post" action="reschedule-check-your-answers">
          <input type="hidden" name="appointmentTime" value="10:00">
          <input type="hidden" name="slotId" value="2025-10-16T10:00:00.000Z">
          <button type="submit" class="govuk-button govuk-button--secondary" data-module="govuk-button">10:00</button>
      </form>
  </div>
  

  <div class="afternoon-slots">
      <form method="post" action="reschedule-check-your-answers">
          <input type="hidden" name="appointmentTime" value="14:00">
          <input type="hidden" name="slotId" value="2025-10-16T14:00:00.000Z">
          <button type="submit" class="govuk-button govuk-button--secondary" data-module="govuk-button">14:00</button>
      </form>
      <form method="post" action="reschedule-check-your-answers">
          <input type="hidden" name="appointmentTime" value="16:00">
          <input type="hidden" name="slotId" value="2025-10-16T16:00:00.000Z">
          <button type="submit" class="govuk-button govuk-button--secondary" data-module="govuk-button">16:00</button>
      </form>
  </div>
`,

"appointmentDate-5": `
  <h2 class="govuk-heading-l">Available slots</h2>
  <div class="govuk-inset-text">
    All times are shown in British Summer Time (BST) timezone.
  </div>
  <p class="govuk-visually-hidden">Friday 17 October 2025</p>
  

  <div class="morning-slots">
  </div>
  

  <div class="afternoon-slots">
      <form method="post" action="reschedule-check-your-answers">
          <input type="hidden" name="appointmentTime" value="12:30">
          <input type="hidden" name="slotId" value="2025-10-17T12:30:00.000Z">
          <button type="submit" class="govuk-button govuk-button--secondary" data-module="govuk-button">12:30</button>
      </form>
      <form method="post" action="reschedule-check-your-answers">
          <input type="hidden" name="appointmentTime" value="14:00">
          <input type="hidden" name="slotId" value="2025-10-17T14:00:00.000Z">
          <button type="submit" class="govuk-button govuk-button--secondary" data-module="govuk-button">14:00</button>
      </form>
  </div>
`,
    "appointmentDate-6": `
      <h2 class="govuk-heading-l">Available slots</h2>
      <div class="govuk-inset-text">
        All times are shown in British Summer Time (BST) timezone.
      </div>
      <p class="govuk-visually-hidden">Saturday 30 September 2025</p>
        <h3 class="govuk-heading-m"> </h3>
        <p>No slots available</p>
        <h4 class="govuk-heading-m"> </h3>
        <p>No slots available</p>
    `,
    "appointmentDate-7": `
      <h2 class="govuk-heading-l">Available slots</h2>
      <div class="govuk-inset-text">
        All times are shown in British Summer Time (BST) timezone.
      </div>
      <p class="govuk-visually-hidden">Sunday 31 September 2025</p>
        <h3 class="govuk-heading-m"> </h3>
        <p>No slots available</p>
        <h4 class="govuk-heading-m"> </h3>
        <p>No slots available</p>
    `,
  };

  // Prototype fallback for days with no slots:
  const noSlotsContent = `
    <h2 class="govuk-heading-l">Available slots</h2>
    <div class="govuk-inset-text">
        All times are shown in British Summer Time (BST) timezone.
      </div>
      <p class="govuk-visually-hidden">Monday 25 September 2025</p>
                <h3 class="govuk-heading-m"> </h3>
                <div class="morning-slots">
                    <form method="post" action="reschedule-check-your-answers">
                        <input type="hidden" name="_name" value="">
                        <button type="submit" class="govuk-button govuk-button--secondary" data-module="govuk-button" data-govuk-button-init=""> 8:00 <span class="govuk-visually-hidden">am</span>
                        </button>
                        <input type="hidden" name="slotId" value="2025-09-25T00:00:00.000Z">
                    </form>
                    <form method="post" action="reschedule-check-your-answers">
                        <input type="hidden" name="_name" value="">
                        <button type="submit" class="govuk-button govuk-button--secondary" data-module="govuk-button" data-govuk-button-init=""> 8:15 <span class="govuk-visually-hidden">am</span>
                        </button>
                        <input type="hidden" name="slotId" value="2025-09-25T00:00:00.000Z">
                    </form>
                    <form method="post" action="reschedule-check-your-answers">
                        <input type="hidden" name="_name" value="">
                        <button type="submit" class="govuk-button govuk-button--secondary" data-module="govuk-button" data-govuk-button-init=""> 8:30 <span class="govuk-visually-hidden">am</span>
                        </button>
                        <input type="hidden" name="slotId" value="2025-09-25T00:00:00.000Z">
                    </form>
                    <form method="post" action="reschedule-check-your-answers">
                        <input type="hidden" name="_name" value="">
                        <button type="submit" class="govuk-button govuk-button--secondary" data-module="govuk-button" data-govuk-button-init=""> 8:45 <span class="govuk-visually-hidden">am</span>
                        </button>
                        <input type="hidden" name="slotId" value="2025-09-25T00:00:00.000Z">
                    </form>
                    <form method="post" action="reschedule-check-your-answers">
                        <input type="hidden" name="_name" value="">
                        <button type="submit" class="govuk-button govuk-button--secondary" data-module="govuk-button" data-govuk-button-init=""> 9:00 <span class="govuk-visually-hidden">am</span>
                        </button>
                        <input type="hidden" name="slotId" value="2025-09-25T00:00:00.000Z">
                    </form>
                    <form method="post" action="reschedule-check-your-answers">
                        <input type="hidden" name="_name" value="">
                        <button type="submit" class="govuk-button govuk-button--secondary" data-module="govuk-button" data-govuk-button-init=""> 9:15 <span class="govuk-visually-hidden">am</span>
                        </button>
                        <input type="hidden" name="slotId" value="2025-09-25T00:00:00.000Z">
                    </form>
                    <form method="post" action="reschedule-check-your-answers">
                        <input type="hidden" name="_name" value="">
                        <button type="submit" class="govuk-button govuk-button--secondary" data-module="govuk-button" data-govuk-button-init=""> 9:30 <span class="govuk-visually-hidden">am</span>
                        </button>
                        <input type="hidden" name="slotId" value="2025-09-25T00:00:00.000Z">
                    </form>
                    <form method="post" action="reschedule-check-your-answers">
                        <input type="hidden" name="_name" value="">
                        <button type="submit" class="govuk-button govuk-button--secondary" data-module="govuk-button" data-govuk-button-init=""> 9:45 <span class="govuk-visually-hidden">am</span>
                        </button>
                        <input type="hidden" name="slotId" value="2025-09-25T00:00:00.000Z">
                    </form>
                    <form method="post" action="reschedule-check-your-answers">
                        <input type="hidden" name="_name" value="">
                        <button type="submit" class="govuk-button govuk-button--secondary" data-module="govuk-button" data-govuk-button-init=""> 10:00 <span class="govuk-visually-hidden">am</span>
                        </button>
                        <input type="hidden" name="slotId" value="2025-09-25T00:00:00.000Z">
                    </form>
                    <form method="post" action="reschedule-check-your-answers">
                        <input type="hidden" name="_name" value="">
                        <button type="submit" class="govuk-button govuk-button--secondary" data-module="govuk-button" data-govuk-button-init=""> 10:15 <span class="govuk-visually-hidden">am</span>
                        </button>
                        <input type="hidden" name="slotId" value="2025-09-25T00:00:00.000Z">
                    </form>
                    <form method="post" action="reschedule-check-your-answers">
                        <input type="hidden" name="_name" value="">
                        <button type="submit" class="govuk-button govuk-button--secondary" data-module="govuk-button" data-govuk-button-init=""> 10:30 <span class="govuk-visually-hidden">am</span>
                        </button>
                        <input type="hidden" name="slotId" value="2025-09-25T00:00:00.000Z">
                    </form>
                    <form method="post" action="reschedule-check-your-answers">
                        <input type="hidden" name="_name" value="">
                        <button type="submit" class="govuk-button govuk-button--secondary" data-module="govuk-button" data-govuk-button-init=""> 10:45 <span class="govuk-visually-hidden">am</span>
                        </button>
                        <input type="hidden" name="slotId" value="2025-09-25T00:00:00.000Z">
                    </form>
                    <form method="post" action="reschedule-check-your-answers">
                        <input type="hidden" name="_name" value="">
                        <button type="submit" class="govuk-button govuk-button--secondary" data-module="govuk-button" data-govuk-button-init=""> 11:00 <span class="govuk-visually-hidden">am</span>
                        </button>
                        <input type="hidden" name="slotId" value="2025-09-25T00:00:00.000Z">
                    </form>
                    <form method="post" action="reschedule-check-your-answers">
                        <input type="hidden" name="_name" value="">
                        <button type="submit" class="govuk-button govuk-button--secondary" data-module="govuk-button" data-govuk-button-init=""> 11:15 <span class="govuk-visually-hidden">am</span>
                        </button>
                        <input type="hidden" name="slotId" value="2025-09-25T00:00:00.000Z">
                    </form>
                    <form method="post" action="reschedule-check-your-answers">
                        <input type="hidden" name="_name" value="">
                        <button type="submit" class="govuk-button govuk-button--secondary" data-module="govuk-button" data-govuk-button-init=""> 11:30 <span class="govuk-visually-hidden">am</span>
                        </button>
                        <input type="hidden" name="slotId" value="2025-09-25T00:00:00.000Z">
                    </form>
                    <form method="post" action="reschedule-check-your-answers">
                        <input type="hidden" name="_name" value="">
                        <button type="submit" class="govuk-button govuk-button--secondary" data-module="govuk-button" data-govuk-button-init=""> 11:45 <span class="govuk-visually-hidden">am</span>
                        </button>
                        <input type="hidden" name="slotId" value="2025-09-25T00:00:00.000Z">
                    </form>
                </div>
                <h3 class="govuk-heading-m"> </h3>
                <div class="afternoon-slots">
                    <form method="post" action="reschedule-check-your-answers">
                        <input type="hidden" name="_name" value="">
                        <button type="submit" class="govuk-button govuk-button--secondary" data-module="govuk-button" data-govuk-button-init=""> 12:00 <span class="govuk-visually-hidden">pm</span>
                        </button>
                        <input type="hidden" name="slotId" value="2025-09-25T00:00:00.000Z">
                    </form>
                    <form method="post" action="reschedule-check-your-answers">
                        <input type="hidden" name="_name" value="">
                        <button type="submit" class="govuk-button govuk-button--secondary" data-module="govuk-button" data-govuk-button-init=""> 12:15 <span class="govuk-visually-hidden">pm</span>
                        </button>
                        <input type="hidden" name="slotId" value="2025-09-25T00:00:00.000Z">
                    </form>
                    <form method="post" action="reschedule-check-your-answers">
                        <input type="hidden" name="_name" value="">
                        <button type="submit" class="govuk-button govuk-button--secondary" data-module="govuk-button" data-govuk-button-init=""> 12:30 <span class="govuk-visually-hidden">pm</span>
                        </button>
                        <input type="hidden" name="slotId" value="2025-09-25T00:00:00.000Z">
                    </form>
                    <form method="post" action="reschedule-check-your-answers">
                        <input type="hidden" name="_name" value="">
                        <button type="submit" class="govuk-button govuk-button--secondary" data-module="govuk-button" data-govuk-button-init=""> 12:45 <span class="govuk-visually-hidden">pm</span>
                        </button>
                        <input type="hidden" name="slotId" value="2025-09-25T00:00:00.000Z">
                    </form>
                    <form method="post" action="reschedule-check-your-answers">
                        <input type="hidden" name="_name" value="">
                        <button type="submit" class="govuk-button govuk-button--secondary" data-module="govuk-button" data-govuk-button-init=""> 1:00 <span class="govuk-visually-hidden">pm</span>
                        </button>
                        <input type="hidden" name="slotId" value="2025-09-25T00:00:00.000Z">
                    </form>
                    <form method="post" action="reschedule-check-your-answers">
                        <input type="hidden" name="_name" value="">
                        <button type="submit" class="govuk-button govuk-button--secondary" data-module="govuk-button" data-govuk-button-init=""> 1:15 <span class="govuk-visually-hidden">pm</span>
                        </button>
                        <input type="hidden" name="slotId" value="2025-09-25T00:00:00.000Z">
                    </form>
                    <form method="post" action="reschedule-check-your-answers">
                        <input type="hidden" name="_name" value="">
                        <button type="submit" class="govuk-button govuk-button--secondary" data-module="govuk-button" data-govuk-button-init=""> 1:30 <span class="govuk-visually-hidden">pm</span>
                        </button>
                        <input type="hidden" name="slotId" value="2025-09-25T00:00:00.000Z">
                    </form>
                    <form method="post" action="reschedule-check-your-answers">
                        <input type="hidden" name="_name" value="">
                        <button type="submit" class="govuk-button govuk-button--secondary" data-module="govuk-button" data-govuk-button-init=""> 1:45 <span class="govuk-visually-hidden">pm</span>
                        </button>
                        <input type="hidden" name="slotId" value="2025-09-25T00:00:00.000Z">
                    </form>
                    <form method="post" action="reschedule-check-your-answers">
                        <input type="hidden" name="_name" value="">
                        <button type="submit" class="govuk-button govuk-button--secondary" data-module="govuk-button" data-govuk-button-init=""> 2:00 <span class="govuk-visually-hidden">pm</span>
                        </button>
                        <input type="hidden" name="slotId" value="2025-09-25T00:00:00.000Z">
                    </form>
                    <form method="post" action="reschedule-check-your-answers">
                        <input type="hidden" name="_name" value="">
                        <button type="submit" class="govuk-button govuk-button--secondary" data-module="govuk-button" data-govuk-button-init=""> 2:15 <span class="govuk-visually-hidden">pm</span>
                        </button>
                        <input type="hidden" name="slotId" value="2025-09-25T00:00:00.000Z">
                    </form>
                    <form method="post" action="reschedule-check-your-answers">
                        <input type="hidden" name="_name" value="">
                        <button type="submit" class="govuk-button govuk-button--secondary" data-module="govuk-button" data-govuk-button-init=""> 2:30 <span class="govuk-visually-hidden">pm</span>
                        </button>
                        <input type="hidden" name="slotId" value="2025-09-25T00:00:00.000Z">
                    </form>
                    <form method="post" action="reschedule-check-your-answers">
                        <input type="hidden" name="_name" value="">
                        <button type="submit" class="govuk-button govuk-button--secondary" data-module="govuk-button" data-govuk-button-init=""> 2:45 <span class="govuk-visually-hidden">pm</span>
                        </button>
                        <input type="hidden" name="slotId" value="2025-09-25T00:00:00.000Z">
                    </form>
                    <form method="post" action="reschedule-check-your-answers">
                        <input type="hidden" name="_name" value="">
                        <button type="submit" class="govuk-button govuk-button--secondary" data-module="govuk-button" data-govuk-button-init=""> 3:00 <span class="govuk-visually-hidden">pm</span>
                        </button>
                        <input type="hidden" name="slotId" value="2025-09-25T00:00:00.000Z">
                    </form>
                    <form method="post" action="reschedule-check-your-answers">
                        <input type="hidden" name="_name" value="">
                        <button type="submit" class="govuk-button govuk-button--secondary" data-module="govuk-button" data-govuk-button-init=""> 3:15 <span class="govuk-visually-hidden">pm</span>
                        </button>
                        <input type="hidden" name="slotId" value="2025-09-25T00:00:00.000Z">
                    </form>
                    <form method="post" action="reschedule-check-your-answers">
                        <input type="hidden" name="_name" value="">
                        <button type="submit" class="govuk-button govuk-button--secondary" data-module="govuk-button" data-govuk-button-init=""> 3:30 <span class="govuk-visually-hidden">pm</span>
                        </button>
                        <input type="hidden" name="slotId" value="2025-09-25T00:00:00.000Z">
                    </form>
                    <form method="post" action="reschedule-check-your-answers">
                        <input type="hidden" name="_name" value="">
                        <button type="submit" class="govuk-button govuk-button--secondary" data-module="govuk-button" data-govuk-button-init=""> 3:45 <span class="govuk-visually-hidden">pm</span>
                        </button>
                        <input type="hidden" name="slotId" value="2025-09-25T00:00:00.000Z">
                    </form>
                    <form method="post" action="reschedule-check-your-answers">
                        <input type="hidden" name="_name" value="">
                        <button type="submit" class="govuk-button govuk-button--secondary" data-module="govuk-button" data-govuk-button-init=""> 4:00 <span class="govuk-visually-hidden">pm</span>
                        </button>
                        <input type="hidden" name="slotId" value="2025-09-25T00:00:00.000Z">
                    </form>
                    <form method="post" action="reschedule-check-your-answers">
                        <input type="hidden" name="_name" value="">
                        <button type="submit" class="govuk-button govuk-button--secondary" data-module="govuk-button" data-govuk-button-init=""> 4:15 <span class="govuk-visually-hidden">pm</span>
                        </button>
                        <input type="hidden" name="slotId" value="2025-09-25T00:00:00.000Z">
                    </form>
                    <form method="post" action="reschedule-check-your-answers">
                        <input type="hidden" name="_name" value="">
                        <button type="submit" class="govuk-button govuk-button--secondary" data-module="govuk-button" data-govuk-button-init=""> 4:30 <span class="govuk-visually-hidden">pm</span>
                        </button>
                        <input type="hidden" name="slotId" value="2025-09-25T00:00:00.000Z">
                    </form>
                    <form method="post" action="reschedule-check-your-answers">
                        <input type="hidden" name="_name" value="">
                        <button type="submit" class="govuk-button govuk-button--secondary" data-module="govuk-button" data-govuk-button-init=""> 4:45 <span class="govuk-visually-hidden">pm</span>
                        </button>
                        <input type="hidden" name="slotId" value="2025-09-25T00:00:00.000Z">
                    </form>
                    <form method="post" action="reschedule-check-your-answers">
                        <input type="hidden" name="_name" value="">
                        <button type="submit" class="govuk-button govuk-button--secondary" data-module="govuk-button" data-govuk-button-init=""> 5:00 <span class="govuk-visually-hidden">pm</span>
                        </button>
                        <input type="hidden" name="slotId" value="2025-09-25T00:00:00.000Z">
                    </form>
                    <form method="post" action="reschedule-check-your-answers">
                        <input type="hidden" name="_name" value="">
                        <button type="submit" class="govuk-button govuk-button--secondary" data-module="govuk-button" data-govuk-button-init=""> 5:15 <span class="govuk-visually-hidden">pm</span>
                        </button>
                        <input type="hidden" name="slotId" value="2025-09-25T00:00:00.000Z">
                    </form>
                    <form method="post" action="reschedule-check-your-answers">
                        <input type="hidden" name="_name" value="">
                        <button type="submit" class="govuk-button govuk-button--secondary" data-module="govuk-button" data-govuk-button-init=""> 5:30 <span class="govuk-visually-hidden">pm</span>
                        </button>
                        <input type="hidden" name="slotId" value="2025-09-25T00:00:00.000Z">
                    </form>
                    <form method="post" action="reschedule-check-your-answers">
                        <input type="hidden" name="_name" value="">
                        <button type="submit" class="govuk-button govuk-button--secondary" data-module="govuk-button" data-govuk-button-init=""> 5:45 <span class="govuk-visually-hidden">pm</span>
                        </button>
                        <input type="hidden" name="slotId" value="2025-09-25T00:00:00.000Z">
                    </form>
                    <form method="post" action="reschedule-check-your-answers">
                        <input type="hidden" name="_name" value="">
                        <button type="submit" class="govuk-button govuk-button--secondary" data-module="govuk-button" data-govuk-button-init=""> 6:00 <span class="govuk-visually-hidden">pm</span>
                        </button>
                        <input type="hidden" name="slotId" value="2025-09-25T00:00:00.000Z">
                    </form>
                </div>
  `;

  //--- End slotsContent config ---

  const tabs = document.querySelectorAll(".appointment-tabs li a");
  const slotsContainer = document.getElementById("slots");

  function clearTabClasses() {
    document.querySelectorAll(".appointment-tabs li").forEach(li => {
      li.classList.remove("tab-0");
    });
  }

  tabs.forEach(tab => {
  tab.addEventListener("click", function(event) {
    event.preventDefault();
    clearTabClasses();
    this.parentElement.classList.add("tab-0");

    // Remove the dummy-slots div if it exists
    var dummySlotsDiv = document.getElementById("dummy-slots");
    if (dummySlotsDiv) {
      dummySlotsDiv.remove();
    }

    // -- Replace the slot content --
    const key = this.getAttribute("id");
    if (slotsContent[key]) {
      slotsContainer.innerHTML = slotsContent[key];
    } else {
      slotsContainer.innerHTML = noSlotsContent;
    }
  });
});

  // To start with no tab active:
  slotsContainer.innerHTML = ""; // Or show guidance text if desired

});
</script>

            <div class="appointment-slots" id="slots">
                <!-- Tab data written in the application.js -->
            </div>
            <div class="appointment-slots" id="dummy-slots">
            <h2 class="govuk-heading-l">Available slots</h2>
            <div class="govuk-inset-text">
        All times are shown in British Summer Time (BST) timezone.
      </div>
            <p class="govuk-visually-hidden">Loading slots</p>
              <h3 class="govuk-heading-m"> </h3>
              <p>Loading slots</p>
              <h4 class="govuk-heading-m"> </h4>
              <p>Loading slots</p>
          </div>
        </div>
      </div>

    </div>
  </div>

{% endblock %}

